## Phase 5: User Experience Polish & Core Usability

**Overall Goal:** Refine the Flicklog application by addressing key usability gaps and implementing quality-of-life features. This phase focuses on enhancing navigation, adding essential user management controls (profile editing, theme switching), and conducting a comprehensive UI review to ensure the final product is intuitive, accessible, and delightful to use.

**Status:** ‚è≥ **Not Started**

---

### Milestone 5.1: Global User Account Management

**Goal:** Empower users with control over their global account settings and provide clear, accessible ways to manage their profile and session. This milestone introduces a dedicated account section and a centralized user menu.
**Key Document References:** `database_schema.md` (Profile table), `project_guideline.md`

| Task ID | Task Description                                                                                      | Backend/Frontend | Verification (How to Confirm)                                                                                                                                              | Status    | Notes/Blockers                                                                                                                                       |
| :------ | :---------------------------------------------------------------------------------------------------- | :--------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :--------------------------------------------------------------------------------------------------------------------------------------------------- |
| P5.1.1  | Create a new top-level page for account settings at `/account/profile`.                               | Frontend         | The route `/account/profile` is created and accessible to a logged-in user. This path is distinct from any space-specific settings.                                         | ‚¨ú To Do | This route can be part of a larger `/account` area, which could later include `/account/security` etc.                                             |
| P5.1.2  | Build the "Edit Profile" form component within the `/account/profile` page.                           | Frontend         | The form renders with inputs for `display_name` and `username`. The `avatar_url` can be a text input for now.                                                              | ‚¨ú To Do | Use `react-hook-form` and a new Zod schema (`profile-schema.ts`) for validation, consistent with existing forms.                                   |
| P5.1.3  | Implement the `updateProfile` Server Action.                                                          | Backend          | **Test:** The action validates the user is authenticated, re-validates the Zod schema, and successfully updates the user's row in the `Profile` table.                         | ‚¨ú To Do | Action should live in a new `profile-actions.ts` file. Ensure `username` uniqueness is handled gracefully (e.g., "Username already taken" error). |
| P5.1.4  | Create a `UserNav` dropdown component.                                                                | Frontend         | A dropdown menu appears when clicking the user's avatar in the main layout header. This is a client component.                                                             | ‚¨ú To Do | This component will house links to "My Account," "Theme Toggle," and "Logout." Use the ShadCN `DropdownMenu`.                                     |
| P5.1.5  | Add a "Logout" button/menu item to the `UserNav` component that calls the existing `signOut` action.    | Both             | Clicking the "Logout" button successfully signs the user out and redirects them to the `/login` page.                                                                    | ‚¨ú To Do | The `signOut` action already exists in `auth-actions.ts`. This is a UI hookup task.                                                                |
| P5.1.6  | Place the new `UserNav` component in the primary application layout.                                  | Frontend         | The user avatar and dropdown menu are visible on all authenticated pages (e.g., in `SpaceLayout` or a higher-level layout).                                               | ‚¨ú To Do | This will likely involve modifying `src/app/spaces/[spaceId]/layout.tsx` or a parent layout.                                                           |

---

### Milestone 5.2: Theme & Accessibility

**Goal:** Implement the light/dark theme toggle as described in the design guidelines, making the application more accessible and personalized.
**Key Document References:** `design_guideline.md`, `tech_stack.md`

| Task ID | Task Description                                                                                | Backend/Frontend | Verification (How to Confirm)                                                                                                                                     | Status    | Notes/Blockers                                                                                                                                                               |
| :------ | :---------------------------------------------------------------------------------------------- | :--------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| P5.2.1  | Install and configure the `next-themes` library.                                                | Frontend         | The dependency is added to `package.json`.                                                                                                                        | ‚¨ú To Do | This is the standard, recommended library for handling themes in Next.js.                                                                                                    |
| P5.2.2  | Create a `ThemeProvider` component that wraps the root layout (`src/app/layout.tsx`).             | Frontend         | The `ThemeProvider` from `next-themes` is correctly configured in the root layout, enabling theme persistence and system preference detection.                      | ‚¨ú To Do | See `next-themes` documentation for the correct setup to avoid hydration mismatches.                                                                                       |
| P5.2.3  | Create a `ThemeToggle` client component.                                                        | Frontend         | A button with sun/moon icons exists. Clicking it toggles the theme between `light` and `dark` by adding/removing a class on the `<html>` element.              | ‚¨ú To Do | This component will use the `useTheme` hook from `next-themes`. Use `lucide-react` for the icons.                                                                          |
| P5.2.4  | Add the `ThemeToggle` component to the new `UserNav` dropdown.                                  | Frontend         | The theme toggle is available and functional from the user's dropdown menu.                                                                                       | ‚¨ú To Do | This ensures the control is always accessible but not cluttering the main UI.                                                                                                |
| P5.2.5  | Verify both `light` and `dark` themes match the `design_guideline.md` specifications perfectly. | Frontend         | **Verification:** All colors (background, text, primary, secondary) correctly switch and match the HEX/OKLCH values defined in the design guidelines for both modes. | ‚¨ú To Do | A thorough visual check is required. The `globals.css` file should contain the necessary CSS variables for both themes under `:root` and `.dark` selectors.              |

---

### Milestone 5.3: Contextual Navigation & Layout Enhancements

**Goal:** Resolve navigation dead-ends within spaces and improve the user's sense of place within the application, particularly within the nested space routes.
**Key Document References:** `project_guideline.md`, `flicklog.md`

| Task ID | Task Description                                                                                              | Backend/Frontend | Verification (How to Confirm)                                                                                                                                                               | Status    | Notes/Blockers                                                                                                                                                                |
| :------ | :------------------------------------------------------------------------------------------------------------ | :--------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| P5.3.1  | Create a reusable `Breadcrumbs` component.                                                                    | Frontend         | The component accepts an array of `{href, label}` objects and renders a navigable breadcrumb trail (e.g., `Movie Club > Settings`).                                                       | ‚¨ú To Do | This will be a client component that uses `usePathname` to generate segments, or a server component that receives segments as props.                                       |
| P5.3.2  | Design a dynamic `PageHeader` component for use in layouts.                                                   | Frontend         | A component that can display a page title, optional actions (like a "Create New" button), and the new `Breadcrumbs` component.                                                            | ‚¨ú To Do | This standardizes the top section of each page.                                                                                                                               |
| P5.3.3  | Implement the `PageHeader` in the `SpaceLayout` (`src/app/spaces/[spaceId]/layout.tsx`).                        | Frontend         | **Verification:** When navigating to `/spaces/[id]/settings`, the user sees a header with breadcrumbs like "[Space Name] / Settings" and can click to navigate back to the space library.   | ‚¨ú To Do | **This is the core fix for the navigation issue.** It provides clear context and escape hatches from deep pages.                                                               |
| P5.3.4  | Refine the `SpaceSwitcher` component to visually indicate the currently active space.                           | Frontend         | In the dropdown list of spaces, the current space is highlighted (e.g., bold text, different background color, or a checkmark icon).                                                       | ‚¨ú To Do | This is a small but significant UX improvement. The `spaceId` from the URL params can be used to determine which item to highlight.                                         |
| P5.3.5  | Add a "Space Settings" link to the `PageHeader` when viewing a space's library.                               | Frontend         | From a space's main dashboard (`/spaces/[id]`), there is a clear, visible link/icon to navigate to its settings page. This can be placed in the new `PageHeader`.                        | ‚¨ú To Do | This completes the navigation loop, making space management more discoverable.                                                                                                |

---

### Milestone 5.4: General UI Polish & Refinements

**Goal:** Solidify the V1 experience by addressing common edge cases, improving user feedback, and conducting the final UI consistency pass.
**Key Document References:** `design_guideline.md`, `error_logbook.md`

| Task ID | Task Description                                                                                             | Backend/Frontend | Verification (How to Confirm)                                                                                                                                                            | Status    | Notes/Blockers                                                                                                                                                                       |
| :------ | :----------------------------------------------------------------------------------------------------------- | :--------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| P5.4.1  | Implement "Empty State" components for all data-driven views.                                                | Frontend         | **Verification:** A new user viewing their library, a new shared space with no logs, or the stats page with no data sees a helpful message and a CTA, not a blank section.                   | ‚¨ú To Do | Create a generic `EmptyState` component (`title`, `description`, `icon`, `children` for a CTA button) and apply it to the Library, Stats page, Pending Ratings list, etc.                |
| P5.4.2  | Add `AlertDialog` confirmations for all destructive actions.                                                 | Frontend         | **Verification:** Actions like removing a member, deleting a space (future), or changing a webhook URL now trigger a confirmation dialog asking "Are you sure?".                          | ‚¨ú To Do | The `removeMember` action already has this. Standardize this pattern for any critical or irreversible action. Use the existing `alert-dialog.tsx` component.                            |
| P5.4.3  | Conduct a full review of all form `pending`/`disabled` states.                                               | Frontend         | Every form submission button across the app is correctly disabled and shows a loading indicator while the server action is pending.                                                        | ‚¨ú To Do | This involves consistently using the `useTransition` hook as specified in `project_guideline.md`. Check login, signup, log, invite, and webhook forms.                                  |
| P5.4.4  | **[DEFERRED TASK]** Conduct a full UI review against the `design_guideline.md` (from P3.4.4).                | Frontend         | All pages are checked for consistent spacing, typography, colors, and border-radii. Any deviations from `design_guideline.md` are corrected.                                             | ‚¨ú To Do | This is a dedicated "design QA" task. Go through every page and component with the design guidelines open and fix all inconsistencies. This is crucial for a polished feel.          |
| P5.4.5  | Add a "Delete Space" functionality in the space settings page.                                               | Both             | An `ADMIN` of a shared space or the owner of a personal space sees a "Delete Space" button in settings, which, after confirmation, removes the space and all related data.              | üü® Stretch | **This is a stretch goal for this phase.** It's a critical feature but requires careful implementation of cascading deletes in the database or a complex server action transaction. |

---

### **End of Phase 5 Review:**

- **Can a user edit their profile and log out easily from a global menu?** ‚¨ú
- **Can a user toggle between light and dark themes?** ‚¨ú
- **Is in-space navigation clear and are there no more dead-ends?** ‚¨ú
- **Does the UI handle empty states gracefully?** ‚¨ú
- **Are all destructive actions protected by confirmations?** ‚¨ú
- **Is the application's visual language consistent and aligned with the design guidelines?** ‚¨ú
- **Does the app feel complete and robust from a user's perspective?** ‚¨ú
